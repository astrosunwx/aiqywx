# 消息模板管理 - 完整预留模块方案

## 🎯 核心问题解决

**问题1：预留模块太少**
```
现状：只有 售前、售后 两个预留模块
需求：应包括 查询项目、查询加急、申请取消、售后维修 四个完整模块
```

**问题2：内容和文档不一致**
```
现状：模板内容和AI对话功能总结文档中的示例不一致
需求：确保预留模块内容完全对应文档中的对话流程
```

**问题3：@智能助手配置不清**
```
现状：不清楚@智能助手是单独配置，还是直接用？会不会涉及预留模块？
需求：明确说明配置方式和与预留模块的关系
```

---

## 📋 完整的预留模块体系

### 模块总览

```
消息模板管理 → 🤖 AI回复模板
  ↓
  ├─ 【预留模块1】查询项目（QUERY_PROJECT）⭐ 新增
  │  └─ 触发关键词：查询项目、查项目、项目进度、订单
  │  └─ 应答对象：所有外部顾客
  │  └─ 回复内容：项目列表链接 + 进度提示
  │
  ├─ 【预留模块2】查询加急（URGENT_REQUEST）⭐ 新增
  │  └─ 触发关键词：加急、催促、急件、尽快
  │  └─ 应答对象：所有外部顾客
  │  └─ 回复内容：加急流程说明 + 工作时间提示
  │
  ├─ 【预留模块3】申请取消（CANCEL_REQUEST）⭐ 新增
  │  └─ 触发关键词：取消、退单、作废、反悔
  │  └─ 应答对象：所有外部顾客
  │  └─ 回复内容：取消流程 + 注意事项
  │
  ├─ 【预留模块4】售后维修（AFTERSALE_SERVICE）⭐ 已有
  │  └─ 触发关键词：售后、维修、故障、坏了、维修
  │  └─ 应答对象：所有外部顾客
  │  └─ 回复内容：工单号 + 技术员信息 + {technician}变量
  │
  └─ 【预留模块5】售前咨询（PRESALE_INQUIRY）⭐ 已有
     └─ 触发关键词：咨询、价格、产品、报价
     └─ 应答对象：所有外部顾客
     └─ 回复内容：咨询记录 + 销售顾问信息
```

---

## 🔧 四个完整预留模块详解

### 【预留模块1】查询项目（QUERY_PROJECT）

**使用场景**
```
客户：我要查询项目进度
         ↓
系统识别关键词：查询、项目、进度
         ↓
触发预留模块：QUERY_PROJECT
         ↓
自动回复：项目列表链接 + 进度说明
```

**模板配置**

| 配置项 | 值 |
|-------|-----|
| 模块ID | QUERY_PROJECT |
| 模块名称 | 查询项目 |
| 触发场景 | 查询项目 |
| 使用场景 | 客户查询项目进度 |
| 模板类型 | 纯文本 |
| 预留关键词 | query_project, check_project, project_status, order_status |

**预留内容模板**

```
您好，{customer_name}！

我们为您查询到以下项目：

{projects_list}

📊 项目列表链接：
🔗 https://{baseUrl}/project/list?customer_id={customer_id}

点击链接可以：
✅ 查看详细进度
✅ 上传/下载资料
✅ 提交售后工单
✅ 申请加急或取消

如有任何问题，欢迎随时咨询！
```

**可用变量**
```
{customer_name}      - 客户名称
{customer_id}        - 客户ID
{baseUrl}            - 基础域名（从localStorage读取）
{projects_list}      - 自动生成的项目列表（AI填充）
{project_count}      - 项目数量
{recent_status}      - 最近一个项目的状态
```

**AI处理逻辑**
```python
def handle_query_project(customer_phone: str):
    # 1. 查询客户信息
    customer = get_customer_by_phone(customer_phone)
    
    # 2. 查询所有项目
    projects = query_projects(customer_id=customer.id)
    
    # 3. 格式化项目列表
    projects_list = format_projects(projects)
    
    # 4. 填充模板
    response = fill_template(
        template='QUERY_PROJECT',
        variables={
            'customer_name': customer.name,
            'customer_id': customer.id,
            'projects_list': projects_list,
            'project_count': len(projects)
        }
    )
    
    return response
```

---

### 【预留模块2】查询加急（URGENT_REQUEST）

**使用场景**
```
客户：我要加急处理
         ↓
系统识别关键词：加急、催促、尽快
         ↓
触发预留模块：URGENT_REQUEST
         ↓
自动回复：加急流程 + 条件说明
```

**模板配置**

| 配置项 | 值 |
|-------|-----|
| 模块ID | URGENT_REQUEST |
| 模块名称 | 查询加急 |
| 触发场景 | 查询加急 |
| 使用场景 | 客户申请项目加急 |
| 模板类型 | 纯文本 |
| 预留关键词 | urgent, rush, hurry, accelerate, speed_up |

**预留内容模板**

```
您好，{customer_name}！

感谢您提出加急需求。我们可以为您加快处理。

⏰ 加急处理流程：

1️⃣ 确认加急事由
   • 项目号：{project_id}
   • 项目名称：{project_title}
   • 当前状态：{current_status}
   • 您的加急原因：{urgency_reason}

2️⃣ 加急费用（如适用）
   • 标准处理：无额外费用，工作日3-5天
   • 加急处理：+20% 费用，1-2个工作日
   • 特急处理：+50% 费用，24小时内

3️⃣ 申请加急
   请回复：
   • 同意加急费用：回复 "确认加急"
   • 仍需标准处理：回复 "继续等待"
   • 需要咨询：回复 "咨询详情"

4️⃣ 确认后流程
   ✅ 我们会立即安排
   ✅ {technician}工程师将优先处理
   ✅ 预计 {expected_completion} 前完成

⚠️ 工作时间：工作日 10:00-18:30
   • 周一至周五正常处理
   • 周六日可预约上门（加收100元假期费）
   • 法定假期暂停服务

📞 如有疑问，欢迎咨询：{contact_phone}
```

**可用变量**
```
{customer_name}           - 客户名称
{project_id}              - 项目ID
{project_title}           - 项目标题
{current_status}          - 当前处理状态
{urgency_reason}          - 客户填写的加急原因
{technician}              - 负责技术员名称
{expected_completion}     - 预计完成时间
{contact_phone}           - 联系电话
{working_hours}           - 工作时间
```

**AI处理逻辑**
```python
def handle_urgent_request(customer_phone: str, message: str):
    # 1. 查询客户的项目
    customer = get_customer_by_phone(customer_phone)
    projects = query_projects(customer_id=customer.id, status='processing')
    
    # 2. 如果有多个项目，让客户选择
    if len(projects) > 1:
        return {
            'type': 'need_selection',
            'message': '请问需要加急的项目是哪一个？',
            'options': [f"{p.id}: {p.title}" for p in projects]
        }
    
    # 3. 提取加急原因
    urgency_reason = extract_urgency_reason(message)
    
    # 4. 填充模板
    response = fill_template(
        template='URGENT_REQUEST',
        variables={
            'customer_name': customer.name,
            'project_id': projects[0].id,
            'project_title': projects[0].title,
            'current_status': projects[0].status,
            'urgency_reason': urgency_reason,
            'technician': projects[0].assigned_to_name
        }
    )
    
    return response
```

---

### 【预留模块3】申请取消（CANCEL_REQUEST）

**使用场景**
```
客户：我要取消订单
         ↓
系统识别关键词：取消、退单、作废
         ↓
触发预留模块：CANCEL_REQUEST
         ↓
自动回复：取消流程 + 条件限制
```

**模板配置**

| 配置项 | 值 |
|-------|-----|
| 模块ID | CANCEL_REQUEST |
| 模块名称 | 申请取消 |
| 触发场景 | 申请取消 |
| 使用场景 | 客户申请项目取消/退单 |
| 模板类型 | 纯文本 |
| 预留关键词 | cancel, withdraw, refund, return, undo |

**预留内容模板**

```
您好，{customer_name}！

您已提出取消申请。我们会为您评估取消可行性。

❌ 取消流程与条件：

1️⃣ 核实项目信息
   • 项目号：{project_id}
   • 项目名称：{project_title}
   • 当前状态：{current_status}
   • 下单时间：{order_date}
   • 已执行：{executed_percentage}%

2️⃣ 取消条件评估
   ✅ 可以取消的情况：
      • 【未开始】项目未开始施工（可全额退款）
      • 【已开始】项目已开始但未完成
        └─ 退款：合同金额 × (100% - 已执行%) - 已发生费用
      
   ❌ 可能不能取消：
      • 【已完成】项目已全部完成（不可取消）
      • 【材料采购】已购买材料（需承担材料费）
      • 【上门施工】已上门施工（需承担人工费）

3️⃣ 申请取消
   请确认：
   • 了解取消条款：回复 "同意"
   • 放弃取消：回复 "保留"
   • 需要详细咨询：回复 "咨询"

4️⃣ 审批流程
   ✅ 提交申请后24小时内审批
   ✅ {technician}工程师将核实现场情况
   ✅ 核实后3-5个工作日完成退款
   ✅ 发票等相关凭证需提供

⚠️ 重要提示：
   • 取消一旦确认，不可再要求恢复
   • 未动工项目可全额退款
   • 已动工项目需扣除已发生费用
   • 定制产品可能不支持退款

📞 取消咨询电话：{contact_phone}
🕐 工作时间：工作日 10:00-18:30
```

**可用变量**
```
{customer_name}           - 客户名称
{project_id}              - 项目ID
{project_title}           - 项目标题
{current_status}          - 当前状态
{order_date}              - 下单日期
{executed_percentage}     - 已执行百分比
{technician}              - 负责技术员
{contact_phone}           - 联系电话
{remaining_amount}        - 可退款金额（AI计算）
```

**AI处理逻辑**
```python
def handle_cancel_request(customer_phone: str):
    # 1. 查询客户的项目
    customer = get_customer_by_phone(customer_phone)
    projects = query_projects(customer_id=customer.id)
    
    # 2. 筛选可取消的项目（非已完成）
    cancelable_projects = [p for p in projects 
                          if p.status != 'completed']
    
    # 3. 计算退款金额
    for project in cancelable_projects:
        executed_pct = calculate_executed_percentage(project)
        refund_amount = project.amount * (1 - executed_pct/100) - get_costs(project)
        project.estimated_refund = refund_amount
    
    # 4. 填充模板
    response = fill_template(
        template='CANCEL_REQUEST',
        variables={
            'customer_name': customer.name,
            'projects': format_projects(cancelable_projects),
            'technician': get_assigned_technician(projects[0].id)
        }
    )
    
    return response
```

---

### 【预留模块4】售后维修（AFTERSALE_SERVICE）⭐ 已有

**使用场景**
```
客户：我的空调坏了
         ↓
系统识别关键词：售后、维修、故障、坏了
         ↓
触发预留模块：AFTERSALE_SERVICE
         ↓
自动回复：工单号 + 技术员信息 + 承诺时间
```

**模板配置**

| 配置项 | 值 |
|-------|-----|
| 模块ID | AFTERSALE_SERVICE |
| 模块名称 | 售后维修 |
| 触发场景 | 售后服务 |
| 使用场景 | 客户报告故障/申请售后 |
| 模板类型 | 纯文本 |
| 预留关键词 | aftersale, maintenance, repair, fault, broken |

**预留内容模板（修正版）**

```
感谢您的反馈，{customer_name}！

我们已为您创建售后工单，将尽快处理。

🔧 工单信息：

工单号：{ticket_id}
客户：{customer_name}（{customer_phone}）
产品：{product_name}
故障描述：{fault_description}
创建时间：{created_time}

📍 预计上门时间：
✅ {expected_visit_date} {expected_visit_time}

👨‍🔧 技术员信息：
姓名：{technician}
电话：{technician_phone}
工程等级：{technician_level}

💡 上门前准备：
✅ 清空产品周围空间（便于操作）
✅ 确保电源畅通
✅ 准备好发票或订单证明
✅ 记住故障现象描述

🚨 重要提示：
我们的技术员 {technician} 将准时上门服务。
请保持电话畅通，如有变化请及时通知我们。

📞 工单咨询：{contact_phone}
🔗 工单详情：https://{baseUrl}/secure/project/{project_token}
   （此链接24小时内有效，请勿分享给他人）

如需取消或修改时间，请在 {service_deadline} 前告知！
```

**可用变量**
```
{customer_name}           - 客户名称
{customer_phone}          - 客户电话
{ticket_id}               - 工单号
{product_name}            - 产品名称
{fault_description}       - 故障描述
{created_time}            - 创建时间
{expected_visit_date}     - 预计上门日期
{expected_visit_time}     - 预计上门时间
{technician}              - 技术员名称 ⭐ 关键变量
{technician_phone}        - 技术员电话
{technician_level}        - 技术员等级
{contact_phone}           - 联系电话
{baseUrl}                 - 基础域名
{project_token}           - 项目Token（安全链接）
{service_deadline}        - 取消期限
```

**AI处理逻辑**
```python
def handle_aftersale_service(customer_phone: str, fault_description: str):
    # 1. 查询客户信息
    customer = get_customer_by_phone(customer_phone)
    
    # 2. 查询客户的最新项目（关联产品信息）
    recent_project = query_recent_project(customer_id=customer.id)
    
    # 3. 创建工单
    ticket = create_ticket(
        customer_id=customer.id,
        fault_description=fault_description,
        status='pending',
        priority='normal'
    )
    
    # 4. 自动分配技术员
    technician = assign_technician(
        project_id=recent_project.id,
        skill_required='repair'
    )
    
    # 5. 计算预计上门时间（工作时间内）
    expected_visit = calculate_visit_time(
        priority=ticket.priority,
        timezone='Asia/Shanghai'
    )
    
    # 6. 填充模板
    response = fill_template(
        template='AFTERSALE_SERVICE',
        variables={
            'customer_name': customer.name,
            'customer_phone': customer.phone,
            'ticket_id': ticket.id,
            'product_name': recent_project.equipment.name,
            'fault_description': fault_description,
            'technician': technician.name,
            'technician_phone': technician.phone,
            'expected_visit_date': expected_visit.date(),
            'expected_visit_time': expected_visit.time(),
            'project_token': recent_project.project_link_token
        }
    )
    
    # 7. 推送到企业微信内部群
    push_to_wechat_group(
        group_id='service_team',
        message=f"新工单：{ticket.id}，客户：{customer.name}，故障：{fault_description}"
    )
    
    return response
```

---

### 【预留模块5】售前咨询（PRESALE_INQUIRY）⭐ 已有

**使用场景**
```
客户：咨询产品价格
         ↓
系统识别关键词：咨询、价格、产品、报价
         ↓
触发预留模块：PRESALE_INQUIRY
         ↓
自动回复：销售顾问信息 + 咨询流程
```

**模板配置**

| 配置项 | 值 |
|-------|-----|
| 模块ID | PRESALE_INQUIRY |
| 模块名称 | 售前咨询 |
| 触发场景 | 售前咨询 |
| 使用场景 | 客户咨询产品、价格、方案 |
| 模板类型 | 纯文本 |
| 预留关键词 | presale, inquiry, price, quote, product |

**预留内容模板**

```
您好，{customer_name}！

感谢您的咨询，我们很高兴为您服务。

📋 咨询记录：
您咨询的：{inquiry_content}
咨询时间：{inquiry_time}
咨询来源：{source}

👨‍💼 您的销售顾问：
姓名：{sales_representative_name}
电话：{sales_representative_phone}
微信：{sales_representative_wechat}
工作时间：工作日 9:00-18:00

📞 联系销售顾问：
✅ 电话咨询：直接致电上述电话
✅ 微信咨询：扫描二维码或搜索微信号
✅ 上门考察：我们可以免费上门勘察

💡 常见问题快速答复：
Q: 价格怎么算？
A: 我们根据您的具体需求定制报价，无隐性费用

Q: 多久能安装？
A: 确认方案后，通常一周内完成安装

Q: 有质保吗？
A: 所有产品享受 {warranty_period} 保修期

Q: 支付方式？
A: 支持：现金、刷卡、银行转账、分期付款

🔗 了解更多：
• 产品介绍：https://{baseUrl}/products
• 成功案例：https://{baseUrl}/cases
• 技术支持：https://{baseUrl}/support

{sales_representative_name} 会在 {response_time} 小时内与您联系。
请保持电话畅通！

感谢您选择我们！
```

**可用变量**
```
{customer_name}                    - 客户名称
{inquiry_content}                  - 咨询内容
{inquiry_time}                     - 咨询时间
{source}                           - 咨询来源（公众号/企业微信等）
{sales_representative_name}        - 销售顾问名称
{sales_representative_phone}       - 销售顾问电话
{sales_representative_wechat}      - 销售顾问微信号
{warranty_period}                  - 保修期限
{response_time}                    - 响应时间（通常4小时）
{baseUrl}                          - 基础域名
```

---

## 🤖 @智能助手配置完整指南

### 问题澄清

**问题1：@智能助手需要单独配置吗？还是可以直接用？**

```
✅ 答案：@智能助手是企业微信官方应用，需要在企业微信后台配置
        配置完成后可以直接用，不需要在消息模板管理中重复配置
```

**问题2：@智能助手也要在模块中添加吗？还是顶多添加一个连接？**

```
✅ 答案：@智能助手 不涉及消息模板管理的预留模块
        消息模板管理（6种模板）和 @智能助手 是两个独立系统
        可以在模板回复中添加 @智能助手 的操作链接
```

**问题3：会不会涉及到预留模块？**

```
✅ 答案：不涉及预留模块
        预留模块用于自动回复（🤖 AI回复模板）
        @智能助手用于员工命令（@机器人 /命令）
        两个系统完全独立，互不影响
```

---

### @智能助手 完整配置方案

#### 第1步：企业微信后台配置（一次性）

```
企业微信管理后台
  ↓
应用与小程序 → 应用
  ↓
新建应用 或 导入应用
  ↓
基本信息设置：
├─ 应用名称：智能助手（或自定义）
├─ 应用描述：智能工单、客户服务、群通知机器人
├─ 应用类型：机器人应用
├─ 可见范围：所有成员 或 指定部门
└─ 接收消息服务器设置（填写后端API地址）

设置回调URL：
├─ 消息接收URL：https://yourdomain.com/api/wechat/callback
├─ EncodingAESKey：自动生成或自定义
└─ Token：自定义（建议32位随机字符串）

获取认证信息：
├─ CorpID：企业微信ID
├─ Secret：应用Secret
└─ AgentID：应用ID

💾 妥善保管这些密钥，后续需要用到！
```

#### 第2步：后端配置（一次性）

**文件：`backend/.env`**
```env
# 企业微信配置
WECHAT_WORK_CORPID=ww123456789abcdef
WECHAT_WORK_SECRET=abc123xyz456
WECHAT_WORK_AGENTID=1000001
WECHAT_WORK_TOKEN=your_random_token_32bit
WECHAT_WORK_ENCODING_AES_KEY=your_aes_key
```

**文件：`backend/app/config.py`**
```python
from pydantic import BaseSettings

class Settings(BaseSettings):
    # 企业微信配置
    WECHAT_WORK_CORPID: str
    WECHAT_WORK_SECRET: str
    WECHAT_WORK_AGENTID: int
    WECHAT_WORK_TOKEN: str
    WECHAT_WORK_ENCODING_AES_KEY: str
    
    class Config:
        env_file = ".env"

settings = Settings()
```

#### 第3步：后端API实现（代码层）

**文件：`backend/app/routers/wechat.py`（已有）**

这个文件处理 @智能助手 收到的所有 @消息：

```python
# 已实现的命令
@router.post("/api/wechat/callback")
async def wechat_callback(request: Request):
    """企业微信回调处理"""
    
    # 验证消息签名
    # 解密消息内容
    # 识别命令：/创建工单、/查询工单、/分配工单等
    # 执行对应业务逻辑
    # 返回回复消息
```

#### 第4步：如何使用 @智能助手（员工操作）

```
使用场景1：员工手动 @机器人

在企业微信群中输入：
@智能助手 /查询工单 SV20240202001
     ↓
机器人立即回复：
工单号：SV20240202001
客户：张三（13800138000）
问题：空调不制冷
状态：处理中
负责人：李工
创建时间：2024-02-02 14:30
更新时间：2024-02-02 15:00


使用场景2：系统自动推送通知（自动 @机器人）

【新工单通知】自动推送（无需@）
┌──────────────────────────┐
│ 【自动创建工单】🔧         │
│ 工单号：SV20240202001     │
│ 客户：张三（13800138000）  │
│ 项目：中央空调安装         │
│ 问题：空调不制冷          │
│                          │
│ 📋 工单详情：https://...  │
│ （安全链接，24小时有效）   │
│                          │
│ 请相关人员尽快处理。       │
│ @全体成员                 │
└──────────────────────────┘


使用场景3：员工快速操作（不需要 @）

在工单推送下方，员工可以直接回复（使用快捷命令）：
分配给李工 → /分配工单 SV20240202001 @李工
标记完成   → /问题已解决 SV20240202001
添加备注   → 空调已维修，运行正常
```

---

## 📊 预留模块 vs @智能助手 对比表

| 功能 | 预留模块（AI回复模板） | @智能助手（群机器人） |
|------|-----------------|------------|
| **位置** | 消息模板管理 → 🤖 AI回复模板 | 企业微信后台 → 应用与小程序 |
| **触发方式** | 自动触发（关键词识别） | 手动 @或 系统自动推送 |
| **使用者** | 外部顾客 | 内部员工 |
| **对话方式** | 顾客和系统多轮对话 | 员工和机器人单向命令 |
| **模块数量** | 5个（查询、加急、取消、售后、咨询） | 无固定模块（通过命令执行） |
| **响应内容** | 预设文本 + AI填充变量 | 数据库查询结果 + 格式化输出 |
| **推送通知** | ❌ 不推送 | ✅ 自动推送到群 |
| **会涉及预留模块吗？** | ✅ 这就是预留模块 | ❌ 不涉及预留模块 |

---

## 🔗 预留模块在消息模板管理中的位置

### 实际配置路径

```
打开浏览器：http://localhost:3000/templates
                     ↓
              消息模板管理页面
                     ↓
        ⚙️ 域名配置 & 快速模板（折叠面板）
                     ↓
            🤖 AI回复模板（第5个标签）
                     ↓
        【新建模板】点击此按钮
                     ↓
         添加预留模块（5选1）
         
         ├─ 【预留模块】查询项目（QUERY_PROJECT）
         ├─ 【预留模块】查询加急（URGENT_REQUEST）
         ├─ 【预留模块】申请取消（CANCEL_REQUEST）
         ├─ 【预留模块】售后维修（AFTERSALE_SERVICE）
         └─ 【预留模块】售前咨询（PRESALE_INQUIRY）
```

### 具体步骤

```
1️⃣ 点击"+ 新建模板"按钮

2️⃣ 弹出表单，填写：
   ├─ 模板名称：【预留模块】查询项目
   ├─ 使用场景：查询项目
   ├─ 模板内容：选择"预留模块"
   │           ↓ 下拉菜单
   │           ☑️ 使用预留模块
   │           ↓ 模块选择
   │           [QUERY_PROJECT]
   ├─ 应答对象：所有外部顾客
   ├─ 关键词：查询项目、查项目、项目进度、订单
   └─ 启用：☑️ 开启

3️⃣ 预留内容自动填充：
   系统会自动显示该模块的预设内容：
   "您好，{customer_name}！
    我们为您查询到以下项目：
    {projects_list}
    📊 项目列表链接：
    🔗 https://{baseUrl}/project/list?customer_id={customer_id}
    ..."

4️⃣ 可以修改预留内容（可选）：
   ☑️ 保持原样（推荐）
   或
   ☐ 自定义修改部分内容

5️⃣ 点击"保存模板"完成配置
```

---

## 🎯 完整工作流程图

### 顾客端 - 消息模板管理预留模块

```
顾客发消息（企业微信或公众号）
        ↓
    "查询项目"
        ↓
  AI识别意图
        ↓
  触发预留模块：QUERY_PROJECT
        ↓
系统自动填充模板变量：
  {customer_name} = 张三
  {customer_id} = 123
  {projects_list} = 自动查询结果
  {baseUrl} = 从localStorage读取
        ↓
返回完整回复：
"您好，张三！我们为您查询到以下项目：
 ......
 🔗 https://abc.ngrok.io/project/list?customer_id=123"
```

### 员工端 - @智能助手

```
新工单创建事件（后台API）
        ↓
系统自动推送到企业微信内部群
        ↓
消息内容：
"【自动创建工单】
 工单号：SV20240202001
 客户：张三
 ......
 请相关人员尽快处理。
 @全体成员"
        ↓
员工可以 @智能助手 回复
  @智能助手 /分配工单 SV20240202001 @李工
        ↓
机器人执行命令，返回结果
```

---

## ✅ 总结清单

### 预留模块部分
- [x] 预留模块1：查询项目（QUERY_PROJECT）- 新增
- [x] 预留模块2：查询加急（URGENT_REQUEST）- 新增
- [x] 预留模块3：申请取消（CANCEL_REQUEST）- 新增
- [x] 预留模块4：售后维修（AFTERSALE_SERVICE）- 已有（修正内容）
- [x] 预留模块5：售前咨询（PRESALE_INQUIRY）- 已有
- [x] 所有模块内容与文档保持一致
- [x] 包括 {technician} 等所有变量

### @智能助手部分
- [x] @智能助手 不需要在模板中添加，是企业微信独立应用
- [x] @智能助手 不涉及预留模块
- [x] @智能助手 是给员工用的命令工具，不是给顾客的
- [x] @智能助手 配置是一次性的，后续直接使用

### 一致性部分
- [x] 所有预留模块内容和《AI对话功能总结-完整清单.md》保持一致
- [x] 售后模块包含 {technician} 变量和上门服务承诺
- [x] 支持"不拒绝任何客户"的包容式理念
- [x] 所有场景都有自动化流程

---

## 📚 相关文档

- [企业微信AI设置完全指南-员工和顾客区分.md](./企业微信AI设置完全指南-员工和顾客区分.md)
- [AI对话功能总结-完整清单.md](./AI对话功能总结-完整清单.md)
- [模板管理-域名配置和预设模板使用指南.md](./模板管理-域名配置和预设模板使用指南.md)

现在，所有 5 个预留模块都已完整定义，内容和文档一致，可以直接在消息模板管理中配置使用！🎉
