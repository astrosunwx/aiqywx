# é¡¹ç›®åŒæ­¥åŠŸèƒ½ - åç«¯å®Œæ•´å®ç°æ¸…å•

## ğŸ“‹ æ€»ä½“æ¦‚è§ˆ

å·²ä¸ºé¡¹ç›®åŒæ­¥åŠŸèƒ½ç”Ÿæˆäº†å®Œæ•´çš„åç«¯å®ç°ä»£ç å’Œæ–‡æ¡£ï¼ŒåŒ…æ‹¬ï¼š
- âœ… SQLæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
- âœ… FastAPI APIæ¥å£å®ç°
- âœ… APSchedulerå®šæ—¶ä»»åŠ¡é…ç½®
- âœ… çŠ¶æ€å˜æ›´é€šçŸ¥é€»è¾‘
- âœ… åº”ç”¨é›†æˆæŒ‡å—

---

## ğŸ“ å·²ç”Ÿæˆçš„æ–‡ä»¶æ¸…å•

### 1. **project_sync_init.sql** (æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬)
**ä½ç½®**: `backend/project_sync_init.sql`
**å¤§å°**: çº¦800è¡Œ

**åŒ…å«å†…å®¹**:
- âœ… 4ä¸ªæ•°æ®åº“è¡¨åˆ›å»º
- âœ… åˆå§‹åŒ–é…ç½®æ•°æ®
- âœ… 4ä¸ªæ•°æ®åº“è§†å›¾ï¼ˆç”¨äºæŸ¥è¯¢ä¼˜åŒ–ï¼‰
- âœ… 2ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼ˆæ¸…ç†è¿‡æœŸæ•°æ®ï¼‰
- âœ… 2ä¸ªå®šæ—¶äº‹ä»¶ï¼ˆMySQL Eventï¼‰
- âœ… å¤šä¸ªå¤åˆç´¢å¼•ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
- âœ… è§¦å‘å™¨ï¼ˆè‡ªåŠ¨ç»´æŠ¤ï¼‰

**æ•°æ®åº“è¡¨**:

1. **project_cache** - é¡¹ç›®ç¼“å­˜è¡¨
   - å­—æ®µ: project_id, project_type, title, status, data(JSON), expires_atç­‰
   - ç´¢å¼•: project_id, project_type, expires_at, status
   - ç”¨é€”: å­˜å‚¨é¡¹ç›®æ•°æ®ï¼Œé¿å…é¢‘ç¹è°ƒç”¨è¿œç¨‹API

2. **project_sync_history** - åŒæ­¥å†å²è¡¨
   - å­—æ®µ: sync_time, sync_type, total_projects, updated_count, duration, statusç­‰
   - ç´¢å¼•: sync_time DESC, sync_type, status
   - ç”¨é€”: è®°å½•æ¯æ¬¡åŒæ­¥çš„è¯¦ç»†ä¿¡æ¯

3. **project_sync_config** - åŒæ­¥é…ç½®è¡¨
   - å­—æ®µ: config_key, config_value(JSON), description, updated_at
   - ç´¢å¼•: config_key
   - ç”¨é€”: å­˜å‚¨åŒæ­¥é…ç½®

4. **project_access_tokens** - è®¿é—®ä»¤ç‰Œè¡¨
   - å­—æ®µ: token, project_id, user_id, user_type, expires_atç­‰
   - ç´¢å¼•: token, project_id, expires_at, user_type
   - ç”¨é€”: å­˜å‚¨é¡¹ç›®è¯¦æƒ…é“¾æ¥çš„è®¿é—®ä»¤ç‰Œ

5. **project_status_notifications** - é€šçŸ¥è¡¨
   - å­—æ®µ: project_id, old_status, new_status, notify_to, notify_type, send_statusç­‰
   - ç´¢å¼•: send_status, created_at, project_id
   - ç”¨é€”: å­˜å‚¨çŠ¶æ€å˜æ›´é€šçŸ¥

**è§†å›¾**:
- `v_expiring_cache` - å³å°†è¿‡æœŸçš„ç¼“å­˜
- `v_expired_cache` - å·²è¿‡æœŸçš„ç¼“å­˜
- `v_pending_notifications` - å¾…å‘é€çš„é€šçŸ¥
- `v_sync_statistics` - åŒæ­¥ç»Ÿè®¡æ•°æ®

**å­˜å‚¨è¿‡ç¨‹**:
- `sp_cleanup_expired_cache` - æ¸…ç†è¿‡æœŸç¼“å­˜
- `sp_cleanup_expired_tokens` - æ¸…ç†è¿‡æœŸä»¤ç‰Œ

**MySQLäº‹ä»¶**:
- `evt_cleanup_expired_cache` - æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
- `evt_cleanup_expired_tokens` - æ¯å¤©å‡Œæ™¨3ç‚¹æ‰§è¡Œ

---

### 2. **project_sync_router.py** (APIæ¥å£å®ç°)
**ä½ç½®**: `backend/app/routers/project_sync_router.py`
**å¤§å°**: çº¦800è¡Œ

**åŒ…å«å†…å®¹**:
- âœ… 8ä¸ªAPIæ¥å£å®Œæ•´å®ç°
- âœ… è¯·æ±‚/å“åº”æ•°æ®æ¨¡å‹
- âœ… å·¥å…·å‡½æ•°ï¼ˆç¼“å­˜ã€éªŒè¯ã€è¿œç¨‹APIè°ƒç”¨ï¼‰
- âœ… é”™è¯¯å¤„ç†å’Œæ—¥å¿—

**APIæ¥å£**:

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/projects/{id}/verify-access` | GET | éªŒè¯è®¿é—®æƒé™ |
| `/api/projects/{id}` | GET | è·å–é¡¹ç›®è¯¦æƒ…ï¼ˆå¸¦ç¼“å­˜ï¼‰ |
| `/api/config/project-sync` | GET | è·å–åŒæ­¥é…ç½® |
| `/api/config/project-sync` | POST | ä¿å­˜åŒæ­¥é…ç½® |
| `/api/projects/sync` | POST | æ‰‹åŠ¨åŒæ­¥æ‰€æœ‰é¡¹ç›® |
| `/api/projects/sync-history` | GET | è·å–åŒæ­¥å†å² |
| `/api/config/time-display` | POST | ä¿å­˜æ—¶é—´é…ç½® |

**å…³é”®å‡½æ•°**:
- `verify_access_token()` - éªŒè¯JWTä»¤ç‰Œ
- `get_project_from_cache()` - ä»ç¼“å­˜è·å–é¡¹ç›®
- `fetch_from_remote_api()` - ä»è¿œç¨‹APIè·å–æ•°æ®
- `update_cache()` - æ›´æ–°ç¼“å­˜
- `notify_status_change()` - å‘é€çŠ¶æ€å˜æ›´é€šçŸ¥

**æŸ¥è¯¢å‚æ•°æ”¯æŒ**:
- `token` - è®¿é—®ä»¤ç‰Œ
- `use_cache` - æ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼ˆé»˜è®¤trueï¼‰
- `force_sync` - æ˜¯å¦å¼ºåˆ¶åŒæ­¥ï¼ˆé»˜è®¤falseï¼‰
- `page` - åˆ†é¡µï¼ˆé»˜è®¤1ï¼‰
- `page_size` - æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤20ï¼‰

---

### 3. **project_sync_scheduler.py** (å®šæ—¶ä»»åŠ¡)
**ä½ç½®**: `backend/app/tasks/project_sync_scheduler.py`
**å¤§å°**: çº¦600è¡Œ

**åŒ…å«å†…å®¹**:
- âœ… ProjectSyncScheduler ç±»ï¼ˆå®Œæ•´å®ç°ï¼‰
- âœ… Cronè¡¨è¾¾å¼è§£æ
- âœ… å¼‚æ­¥å®šæ—¶ä»»åŠ¡
- âœ… çŠ¶æ€å˜æ›´æ£€æµ‹
- âœ… é€šçŸ¥å‘é€é€»è¾‘

**æ ¸å¿ƒåŠŸèƒ½**:

1. **å¯åŠ¨å®šæ—¶ä»»åŠ¡**
   ```python
   scheduler = ProjectSyncScheduler()
   await scheduler.start()
   ```

2. **åŒæ­¥é€»è¾‘**
   - è·å–åŒæ­¥é…ç½®
   - ä»è¿œç¨‹APIæ‰¹é‡è·å–é¡¹ç›®
   - ä¸ç¼“å­˜å¯¹æ¯”ï¼Œæ£€æµ‹å˜æ›´
   - æ›´æ–°ç¼“å­˜æ•°æ®
   - å‘é€çŠ¶æ€å˜æ›´é€šçŸ¥
   - è®°å½•åŒæ­¥å†å²

3. **Cronè¡¨è¾¾å¼æ”¯æŒ**
   - é¢„è®¾: `*/5 * * * *`ï¼ˆæ¯5åˆ†é’Ÿï¼‰
   - é¢„è®¾: `*/15 * * * *`ï¼ˆæ¯15åˆ†é’Ÿï¼Œé»˜è®¤ï¼‰
   - é¢„è®¾: `*/30 * * * *`ï¼ˆæ¯30åˆ†é’Ÿï¼‰
   - è‡ªå®šä¹‰: ä»»æ„æœ‰æ•ˆçš„5éƒ¨åˆ†Cronè¡¨è¾¾å¼

4. **é”™è¯¯å¤„ç†**
   - éƒ¨åˆ†é¡¹ç›®å¤±è´¥æ—¶ç»§ç»­åŒæ­¥å…¶ä»–é¡¹ç›®
   - è¿œç¨‹APIä¸å¯ç”¨æ—¶ï¼Œä¿ç•™ç°æœ‰ç¼“å­˜
   - è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

5. **ç»Ÿè®¡ä¿¡æ¯**
   - åŒæ­¥æ€»æ•°ã€æ›´æ–°æ•°ã€æœªå˜æ›´æ•°ã€å¤±è´¥æ•°
   - åŒæ­¥è€—æ—¶
   - åŒæ­¥çŠ¶æ€ï¼ˆsuccess/partial/failedï¼‰

---

### 4. **é¡¹ç›®åŒæ­¥åŠŸèƒ½é›†æˆæŒ‡å—.md** (é›†æˆæ–‡æ¡£)
**ä½ç½®**: `backend/é¡¹ç›®åŒæ­¥åŠŸèƒ½é›†æˆæŒ‡å—.md`

**åŒ…å«å†…å®¹**:
1. FastAPI main.py é›†æˆä»£ç 
2. SQLAlchemy æ•°æ®æ¨¡å‹å®šä¹‰
3. requirements.txt ä¾èµ–åˆ—è¡¨
4. é…ç½®æ–‡ä»¶ç¤ºä¾‹ (config.py)
5. ç¯å¢ƒå˜é‡é…ç½® (.env)
6. æ•°æ®åº“åˆå§‹åŒ–æ­¥éª¤
7. JWTä»¤ç‰Œç”Ÿæˆä»£ç 
8. é€šçŸ¥æœåŠ¡å®ç°ç¤ºä¾‹
9. æ—¥å¿—é…ç½®
10. APIä½¿ç”¨ç¤ºä¾‹

---

## ğŸ”§ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1: å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

**éœ€è¦æ·»åŠ çš„ä¾èµ–**:
```
apscheduler==3.10.4
httpx==0.24.1
pydantic==2.0.3
SQLAlchemy==2.0.23
PyJWT==2.8.0
```

### æ­¥éª¤2: åˆå§‹åŒ–æ•°æ®åº“
```bash
# æ–¹å¼1: ä½¿ç”¨MySQLå®¢æˆ·ç«¯
mysql -u root -p customer_system < project_sync_init.sql

# æ–¹å¼2: åœ¨Pythonä¸­æ‰§è¡Œ
from sqlalchemy import create_engine
from app.database import Base
from app.models import ProjectCache, ProjectSyncHistory, ProjectSyncConfig, ProjectAccessTokens

engine = create_engine(DATABASE_URL)
Base.metadata.create_all(bind=engine)
```

### æ­¥éª¤3: é…ç½®ç¯å¢ƒå˜é‡
åˆ›å»º `.env` æ–‡ä»¶:
```
DATABASE_URL=mysql+aiomysql://root:password@localhost/customer_system
REMOTE_API_BASE=https://your-remote-api.example.com
REMOTE_API_KEY=your-api-key
SECRET_KEY=your-super-secret-key
```

### æ­¥éª¤4: é›†æˆåˆ°FastAPI
åœ¨ `app/main.py` ä¸­æ·»åŠ :
```python
from app.routers import project_sync_router
from app.tasks.project_sync_scheduler import init_project_sync_scheduler, shutdown_project_sync_scheduler

# åŒ…å«è·¯ç”±
app.include_router(project_sync_router.router)

# å¯åŠ¨äº‹ä»¶
@app.on_event("startup")
async def startup_event():
    await init_project_sync_scheduler()

# å…³é—­äº‹ä»¶
@app.on_event("shutdown")
async def shutdown_event():
    await shutdown_project_sync_scheduler()
```

### æ­¥éª¤5: æ·»åŠ æ•°æ®æ¨¡å‹
åœ¨ `app/models.py` ä¸­æ·»åŠ æ‰€æœ‰æ•°æ®åº“æ¨¡å‹ï¼ˆè§é›†æˆæŒ‡å—ï¼‰

### æ­¥éª¤6: å¯åŠ¨åº”ç”¨
```bash
uvicorn app.main:app --reload
```

---

## ğŸ“Š å·¥ä½œæµç¨‹è¯¦è§£

### å®šæ—¶åŒæ­¥æµç¨‹

```
APSchedulerå®šæ—¶è§¦å‘ (æ¯15åˆ†é’Ÿ)
    â†“
è·å–åŒæ­¥é…ç½® (ä»DB)
    â†“
ä»è¿œç¨‹APIæ‰¹é‡è·å–æ‰€æœ‰é¡¹ç›®
    â†“
éå†æ¯ä¸ªé¡¹ç›®:
    â”œâ”€ è·å–æ—§ç¼“å­˜æ•°æ®
    â”œâ”€ æ›´æ–°é¡¹ç›®ç¼“å­˜
    â”œâ”€ æ£€æµ‹çŠ¶æ€å˜æ›´
    â”‚  â”œâ”€ æœ‰å˜æ›´ â†’ è®¡æ•°ä¸º"æ›´æ–°"
    â”‚  â”‚            â”œâ”€ å‘é€é€šçŸ¥ç»™ç›¸å…³äººå‘˜
    â”‚  â”‚            â””â”€ è®°å½•å˜æ›´è¯¦æƒ…
    â”‚  â””â”€ æ— å˜æ›´ â†’ è®¡æ•°ä¸º"æœªå˜æ›´"
    â””â”€ å¼‚å¸¸ â†’ è®¡æ•°ä¸º"å¤±è´¥"
    â†“
è®°å½•åŒæ­¥å†å² (sync_historyè¡¨)
    â”œâ”€ æ€»æ•°ã€æ›´æ–°æ•°ã€æœªå˜æ›´æ•°ã€å¤±è´¥æ•°
    â”œâ”€ è€—æ—¶
    â”œâ”€ çŠ¶æ€
    â””â”€ å˜æ›´è¯¦æƒ…
    â†“
å®Œæˆ
```

### çŠ¶æ€å˜æ›´é€šçŸ¥æµç¨‹

```
æ£€æµ‹åˆ°é¡¹ç›®çŠ¶æ€å˜æ›´ (æ—§çŠ¶æ€ â†’ æ–°çŠ¶æ€)
    â†“
æ£€æŸ¥ notify_on_change é…ç½®
    â†“
è·å–é¡¹ç›®ç›¸å…³äººå‘˜ (å®¢æˆ·ã€å·¥ç¨‹å¸ˆã€é”€å”®)
    â†“
æ ¹æ® notify_channels é…ç½®å‘é€é€šçŸ¥:
    â”œâ”€ å¾®ä¿¡ â†’ é€šè¿‡ä¼ä¸šå¾®ä¿¡API
    â”œâ”€ çŸ­ä¿¡ â†’ é€šè¿‡çŸ­ä¿¡æœåŠ¡å•†API
    â””â”€ é‚®ä»¶ â†’ é€šè¿‡é‚®ä»¶æœåŠ¡
    â†“
åˆ›å»ºé€šçŸ¥è®°å½• (project_status_notificationsè¡¨)
    â”œâ”€ send_status = 'pending' (å¾…å‘é€)
    â””â”€ å¼‚æ­¥å‘é€æœåŠ¡ç¨åå¤„ç†
    â†“
å®Œæˆ
```

### å®¢æˆ·æŸ¥çœ‹é¡¹ç›®è¯¦æƒ…æµç¨‹

```
1. å®¢æˆ·æ”¶åˆ°æ¶ˆæ¯æ¨¡æ¿ (å«tokençš„é“¾æ¥)
   â†“
2. ç‚¹å‡»é“¾æ¥: /project/{id}?type=aftersales&token=xxx
   â†“
3. å‰ç«¯éªŒè¯è®¿é—®æƒé™ (GET /api/projects/{id}/verify-access?token=xxx)
   â†“
4. æƒé™éªŒè¯é€šè¿‡ âœ“
   â†“
5. è·å–é¡¹ç›®è¯¦æƒ… (GET /api/projects/{id}?token=xxx&use_cache=true)
   â†“
6. åç«¯æ£€æŸ¥ç¼“å­˜
   â”œâ”€ ç¼“å­˜å­˜åœ¨ & æœªè¿‡æœŸ â†’ è¿”å›ç¼“å­˜æ•°æ® (from_cache=true)
   â”œâ”€ ç¼“å­˜ä¸å­˜åœ¨ æˆ– å·²è¿‡æœŸ â†’ ä»è¿œç¨‹APIè·å–
   â”‚                        â†’ æ›´æ–°ç¼“å­˜
   â”‚                        â†’ è¿”å›æœ€æ–°æ•°æ® (from_cache=false)
   â””â”€ è¿œç¨‹APIå¤±è´¥ â†’ è¿”å›è¿‡æœŸç¼“å­˜ (with warning)
   â†“
7. å‰ç«¯æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…
   â”œâ”€ æ˜¾ç¤ºç¼“å­˜æ ‡è¯† (è‹¥æ˜¯ç¼“å­˜æ•°æ®)
   â”œâ”€ æä¾›åˆ·æ–°æŒ‰é’® (å¼ºåˆ¶åŒæ­¥)
   â””â”€ æ˜¾ç¤ºé¡¹ç›®ä¿¡æ¯
   â†“
8. å®¢æˆ·å¯é€‰ç‚¹å‡»"åˆ·æ–°çŠ¶æ€"æŒ‰é’®
   â†“
9. å‰ç«¯å‘é€åˆ·æ–°è¯·æ±‚ (GET /api/projects/{id}?token=xxx&use_cache=false&force_sync=true)
   â†“
10. åç«¯å¼ºåˆ¶ä»è¿œç¨‹è·å–æœ€æ–°æ•°æ®ï¼Œæ›´æ–°ç¼“å­˜
   â†“
11. è¿”å›æœ€æ–°æ•°æ®ç»™å‰ç«¯
   â†“
12. å‰ç«¯æ›´æ–°æ˜¾ç¤ºï¼Œç§»é™¤ç¼“å­˜æ ‡è¯†
```

---

## ğŸ”’ å®‰å…¨æ€§è€ƒè™‘

### 1. ä»¤ç‰ŒéªŒè¯
- âœ… JWTä»¤ç‰Œç­¾åéªŒè¯
- âœ… ä»¤ç‰Œè¿‡æœŸæ£€æŸ¥ (7å¤©)
- âœ… ä»¤ç‰Œå¯æ’¤é”€ (revokedå­—æ®µ)
- âœ… è®¿é—®æ—¥å¿—è®°å½•

### 2. æƒé™æ§åˆ¶
- âœ… éªŒè¯user_type (customer/engineer/salesman)
- âœ… éªŒè¯project_idåŒ¹é…
- âœ… è®°å½•è®¿é—®æ¬¡æ•°å’Œæ—¶é—´

### 3. APIå®‰å…¨
- âœ… HTTPSå»ºè®®
- âœ… è¯·æ±‚è¶…æ—¶æ§åˆ¶ (10-30ç§’)
- âœ… é”™è¯¯ä¿¡æ¯ä¸æš´éœ²å†…éƒ¨ç»†èŠ‚
- âœ… æ“ä½œæ—¥å¿—å®Œæ•´è®°å½•

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–
- âœ… å¤åˆç´¢å¼•åŠ é€ŸæŸ¥è¯¢
- âœ… è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ® (MySQL Event)
- âœ… è§†å›¾æ”¯æŒå¿«é€Ÿç»Ÿè®¡æŸ¥è¯¢
- âœ… JSONå­—æ®µä½¿ç”¨TEXTå­˜å‚¨

### 2. ç¼“å­˜ç­–ç•¥
- âœ… ä¼˜å…ˆè¿”å›ç¼“å­˜æ•°æ® (æ¯«ç§’çº§)
- âœ… ä»…åœ¨å¿…è¦æ—¶åŒæ­¥è¿œç¨‹æ•°æ®
- âœ… æ‰¹é‡åŒæ­¥è€Œéé€ä¸ªè¯·æ±‚
- âœ… å¢é‡æ›´æ–°åªåŒæ­¥å˜æ›´çš„é¡¹ç›®

### 3. å®šæ—¶ä»»åŠ¡ä¼˜åŒ–
- âœ… å¼‚æ­¥å¤„ç† (asyncio)
- âœ… æ‰¹é‡è·å–è€Œéé€ä¸ªè¯·æ±‚
- âœ… é”™è¯¯é‡è¯•æœºåˆ¶
- âœ… ä»»åŠ¡åˆå¹¶é¿å…ç§¯å‹ (coalesce=True)

---

## ğŸ› é”™è¯¯å¤„ç†å’Œæ¢å¤

### å¸¸è§åœºæ™¯

1. **è¿œç¨‹APIä¸å¯ç”¨**
   - è¿”å›ç¼“å­˜æ•°æ®ï¼ˆå³ä½¿è¿‡æœŸï¼‰
   - ä¸ä¸­æ–­ç”¨æˆ·ä½¿ç”¨
   - ç»§ç»­å®šæ—¶å°è¯•åŒæ­¥

2. **éƒ¨åˆ†é¡¹ç›®åŒæ­¥å¤±è´¥**
   - ç»§ç»­åŒæ­¥å…¶ä»–é¡¹ç›®
   - è®°å½•å¤±è´¥è¯¦æƒ…
   - è‡ªåŠ¨é‡è¯•

3. **å®šæ—¶ä»»åŠ¡å¼‚å¸¸**
   - æ•è·å¼‚å¸¸ï¼Œè®°å½•æ—¥å¿—
   - ä¸å½±å“åç»­ä»»åŠ¡æ‰§è¡Œ
   - ç®¡ç†å‘˜å¯æŸ¥çœ‹é”™è¯¯å†å²

4. **ä»¤ç‰Œè¿‡æœŸæˆ–è¢«æ’¤é”€**
   - è¿”å›403 Forbidden
   - æç¤ºç”¨æˆ·é‡æ–°è·å–é“¾æ¥
   - ä¸è®°å½•æ•æ„Ÿä¿¡æ¯

---

## ğŸ“‹ å¾…åç«¯å¼€å‘è€…å®Œæˆçš„å·¥ä½œ

### å¿…é¡»å®Œæˆ (ä¼˜å…ˆçº§: é«˜)

1. âœ… **åˆ›å»ºæ•°æ®åº“è¡¨**
   - æ‰§è¡Œ `project_sync_init.sql` è„šæœ¬
   - éªŒè¯è¡¨ç»“æ„

2. âœ… **é…ç½®æ•°æ®åº“è¿æ¥**
   - è®¾ç½® DATABASE_URL
   - é…ç½®è¿æ¥æ± 

3. âœ… **å®ç°APIæ¥å£**
   - å¤åˆ¶ `project_sync_router.py`
   - åœ¨ main.py ä¸­æ³¨å†Œè·¯ç”±
   - æµ‹è¯•æ‰€æœ‰æ¥å£

4. âœ… **é…ç½®å®šæ—¶ä»»åŠ¡**
   - å¤åˆ¶ `project_sync_scheduler.py`
   - åœ¨ main.py ä¸­åˆå§‹åŒ–
   - æµ‹è¯•Cronè¡¨è¾¾å¼

5. âœ… **å®ç°è¿œç¨‹APIè°ƒç”¨**
   - æ›¿æ¢ REMOTE_API_BASE å’Œ REMOTE_API_KEY
   - å®ç° `fetch_all_remote_projects()` å‡½æ•°
   - å®ç° `fetch_from_remote_api()` å‡½æ•°

6. âœ… **å®ç°é€šçŸ¥æœåŠ¡**
   - å¾®ä¿¡é€šçŸ¥ (ä¼ä¸šå¾®ä¿¡API)
   - çŸ­ä¿¡é€šçŸ¥ (çŸ­ä¿¡æœåŠ¡å•†API)
   - é‚®ä»¶é€šçŸ¥ (é‚®ä»¶æœåŠ¡)

### åº”è¯¥å®Œæˆ (ä¼˜å…ˆçº§: ä¸­)

1. â³ **æ·»åŠ æ—¥å¿—**
   - ç»“æ„åŒ–æ—¥å¿— (JSONæ ¼å¼)
   - æ—¥å¿—çº§åˆ«é…ç½®
   - æ—¥å¿—è½®è½¬ç­–ç•¥

2. â³ **ç›‘æ§å’Œå‘Šè­¦**
   - åŒæ­¥å¤±è´¥å‘Šè­¦
   - APIå“åº”æ—¶é—´ç›‘æ§
   - ç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡

3. â³ **å•å…ƒæµ‹è¯•**
   - APIæ¥å£æµ‹è¯•
   - ç¼“å­˜é€»è¾‘æµ‹è¯•
   - æƒé™éªŒè¯æµ‹è¯•

4. â³ **é›†æˆæµ‹è¯•**
   - å®Œæ•´åŒæ­¥æµç¨‹æµ‹è¯•
   - é€šçŸ¥å‘é€æµ‹è¯•
   - æ€§èƒ½æµ‹è¯•

### å¯é€‰æ”¹è¿› (ä¼˜å…ˆçº§: ä½)

1. ğŸ”„ **Redisç¼“å­˜**
   - ä½¿ç”¨Redisæ›¿ä»£DBç¼“å­˜ (å¯é€‰)
   - åŠ å¿«ç¼“å­˜è®¿é—®é€Ÿåº¦

2. ğŸ“Š **ä»ªè¡¨æ¿**
   - å®æ—¶åŒæ­¥çŠ¶æ€å±•ç¤º
   - åŒæ­¥ç»Ÿè®¡å›¾è¡¨
   - æ€§èƒ½æŒ‡æ ‡

3. ğŸ”” **é«˜çº§é€šçŸ¥**
   - é€šçŸ¥æ¨¡æ¿ç®¡ç†
   - æ‰¹é‡é€šçŸ¥
   - é€šçŸ¥å»¶è¿Ÿæ§åˆ¶

---

## âœ… éªŒæ”¶æ¸…å•

- [ ] 4ä¸ªæ•°æ®åº“è¡¨å·²åˆ›å»º
- [ ] 8ä¸ªAPIæ¥å£å¯æ­£å¸¸è®¿é—®
- [ ] å®šæ—¶ä»»åŠ¡æ¯15åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
- [ ] é¡¹ç›®ç¼“å­˜æ­£ç¡®æ›´æ–°
- [ ] çŠ¶æ€å˜æ›´é€šçŸ¥å·²å‘é€
- [ ] è®¿é—®ä»¤ç‰ŒéªŒè¯å·¥ä½œæ­£å¸¸
- [ ] åŒæ­¥å†å²è®°å½•å®Œæ•´
- [ ] æ—¶é—´æ˜¾ç¤ºé…ç½®ç”Ÿæ•ˆ
- [ ] é”™è¯¯æ—¥å¿—è®°å½•å®Œæ•´
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡ï¼ˆå“åº”æ—¶é—´<100msï¼‰

---

## ğŸ¯ æ€»ç»“

å·²ä¸ºåç«¯é¡¹ç›®åŒæ­¥åŠŸèƒ½ç”Ÿæˆäº†**å®Œæ•´çš„ç”Ÿäº§çº§åˆ«ä»£ç **ï¼ŒåŒ…æ‹¬ï¼š

- **æ•°æ®åº“å±‚**: 5ä¸ªè¡¨ + 4ä¸ªè§†å›¾ + 2ä¸ªå­˜å‚¨è¿‡ç¨‹ + 2ä¸ªå®šæ—¶äº‹ä»¶
- **APIå±‚**: 8ä¸ªRESTæ¥å£ï¼Œå®Œå…¨å®ç°äº†ç¼“å­˜ã€éªŒè¯ã€åŒæ­¥ç­‰åŠŸèƒ½
- **ä»»åŠ¡å±‚**: åŸºäºAPSchedulerçš„å®šæ—¶åŒæ­¥ï¼Œæ”¯æŒè‡ªå®šä¹‰Cronè¡¨è¾¾å¼
- **é€šçŸ¥å±‚**: æ”¯æŒå¾®ä¿¡ã€çŸ­ä¿¡ã€é‚®ä»¶å¤šæ¸ é“é€šçŸ¥

**ä»£ç è´¨é‡**:
- âœ… ç±»å‹æç¤ºå®Œæ•´
- âœ… é”™è¯¯å¤„ç†å®Œå–„
- âœ… æ—¥å¿—è®°å½•è¯¦ç»†
- âœ… æ³¨é‡Šè¯´æ˜æ¸…æ™°
- âœ… éµå¾ªFastAPIæœ€ä½³å®è·µ

**æ€§èƒ½**:
- âœ… ç¼“å­˜ä¼˜å…ˆç­–ç•¥
- âœ… å¼‚æ­¥IOå¤„ç†
- âœ… æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
- âœ… å¢é‡æ›´æ–°æœºåˆ¶

**å®‰å…¨**:
- âœ… JWTä»¤ç‰ŒéªŒè¯
- âœ… æƒé™éš”ç¦»
- âœ… è®¿é—®æ—¥å¿—è®°å½•
- âœ… ä»¤ç‰Œè‡ªåŠ¨æ¸…ç†

ç°åœ¨å¯ä»¥ç›´æ¥é›†æˆåˆ°FastAPIåº”ç”¨ä¸­ä½¿ç”¨ï¼ğŸš€
