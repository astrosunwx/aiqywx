# 模板管理 - 域名配置和预设模板指南

## 🎉 新增功能

现在模板管理中添加了两个新功能：

### ✨ 功能1：域名配置面板
```
📍 基础域名配置
用处：配置ngrok或自定义域名，所有模板链接会自动使用该域名
```

### ✨ 功能2：快速预设模板
```
📝 一键插入预设模板
用处：4种预设模板，快速填充到编辑框，然后DIY修改
```

---

## 🚀 快速开始

### 第1步：访问模板管理
```
http://localhost:3000/templates
```

### 第2步：配置域名（可选但推荐）

在页面顶部看到这个面板：

```
⚙️ 域名配置 & 快速模板
├─ 📍 基础域名配置
│  └─ 输入框：https://xxxx.ngrok.io
│  └─ 按钮：💾 保存域名配置
│
└─ 📝 快速预设模板
   ├─ 🎯 商机通知模板
   ├─ 🔧 工单进度模板
   ├─ 📦 订单确认模板
   └─ 💳 支付催付模板
```

**点击 "⚙️ 域名配置 & 快速模板" 展开**

### 第3步：输入ngrok地址

**如果安装了ngrok：**
```
1. 运行：ngrok http 3000
2. 得到URL：https://a1b2c3d4.ngrok.io
3. 粘贴到输入框
4. 点击"💾 保存域名配置"
```

**如果没安装ngrok：**
```
1. 保持默认：http://localhost:3000
2. 或输入自己的域名：https://yourdomain.com
3. 点击"💾 保存域名配置"
```

### 第4步：使用预设模板

点击下面的任一按钮：

```
🎯 商机通知模板        → 自动打开编辑框，填充商机模板
🔧 工单进度模板        → 自动打开编辑框，填充工单模板  
📦 订单确认模板        → 自动打开编辑框，填充订单模板
💳 支付催付模板        → 自动打开编辑框，填充支付模板
```

### 第5步：修改和保存

```
1. 模板内容已自动填充
2. 修改需要的部分（名称、内容、场景等）
3. 点击"保存模板"
4. 完成！
```

---

## 📋 四种预设模板详解

### 1️⃣ 商机通知模板 (presale)

**自动填充的内容：**
```
尊敬的 {customer_name}，

您的商机已更新！

📊 商机信息：
• 预期成交额：¥{amount}
• 预期成交时间：{date}
• 当前阶段：{status}
• 负责销售：{technician}

👉 点击查看详情：
https://xxxx.ngrok.io/project/{order_id}?type=presale
(会自动使用你配置的域名)

感谢您的信任！
```

**链接类型：** presale（售前商机详情）
**使用场景：** 商机状态变化、跟进提醒

**DIY修改建议：**
- 修改开头问候语
- 添加销售顾问签名
- 调整信息展示顺序

---

### 2️⃣ 工单进度模板 (aftersales)

**自动填充的内容：**
```
尊敬的 {customer_name}，

您的工单 {order_id} 有新的进展！

🔧 工单详情：
• 故障描述：{product}
• 当前状态：{status}
• 处理进度：已处理
• 负责工程师：{technician}

👉 点击查看详情并反馈：
https://xxxx.ngrok.io/project/{order_id}?type=aftersales

如有问题，请随时联系我们。
```

**链接类型：** aftersales（售后工单详情）
**使用场景：** 工单状态更新、完成通知

**DIY修改建议：**
- 添加紧急程度提示
- 增加工程师联系方式
- 个性化问候语

---

### 3️⃣ 订单确认模板 (sales)

**自动填充的内容：**
```
亲爱的 {customer_name}，

感谢您的购买！订单已确认。

📦 订单信息：
• 订单号：{order_id}
• 订单金额：¥{amount}
• 收货地址：{address}
• 预计送达：{date}

👉 点击查看订单详情：
https://xxxx.ngrok.io/project/{order_id}?type=sales

感谢您的支持！
```

**链接类型：** sales（销售订单详情）
**使用场景：** 订单确认通知、支付提醒

**DIY修改建议：**
- 添加订单号强调
- 增加物流信息
- 提醒支付期限

---

### 4️⃣ 支付催付模板 (payment)

**自动填充的内容：**
```
尊敬的 {customer_name}，

您的订单 {order_id} 需要完成支付。

💰 支付信息：
• 订单金额：¥{amount}
• 订单状态：待支付
• 有效期：24小时内

⏰ 请尽快完成支付！

👉 点击前往支付：
https://xxxx.ngrok.io/pay/{order_id}

支付完成后，我们将立即为您发货。
```

**链接类型：** custom（支付页面）
**使用场景：** 支付催付、支付链接分享

**DIY修改建议：**
- 增加紧急性表述
- 添加优惠信息
- 强调时间限制

---

## 🔗 域名配置实时预览

在"域名配置"面板中，你会看到：

```
💡 当前URL配置

基础域名：https://xxxx.ngrok.io

售前商机：https://xxxx.ngrok.io/project/{order_id}?type=presale
售后工单：https://xxxx.ngrok.io/project/{order_id}?type=aftersales
销售订单：https://xxxx.ngrok.io/project/{order_id}?type=sales
在线支付：https://xxxx.ngrok.io/pay/{order_id}
```

**这些URL会在你创建模板时自动使用！**

---

## 💾 数据持久化

### 域名配置保存位置
```
浏览器本地存储 (localStorage)
键：baseUrl
值：你输入的域名地址

即使刷新页面或关闭浏览器，配置也会保留
```

### 如何修改域名
```
1. 清空输入框
2. 输入新的域名
3. 点击"💾 保存域名配置"
4. 完成！
```

### 如何重置为默认
```
1. 输入：http://localhost:3000
2. 点击"💾 保存域名配置"
3. 完成！
```

---

## 🎯 典型使用流程

### 场景1：开发环境测试

```
1️⃣ 安装ngrok
   ngrok http 3000

2️⃣ 复制公网URL
   https://a1b2c3d4.ngrok.io

3️⃣ 进入模板管理
   http://localhost:3000/templates

4️⃣ 展开"域名配置"面板

5️⃣ 粘贴ngrok URL到输入框
   https://a1b2c3d4.ngrok.io

6️⃣ 点击"💾 保存域名配置"

7️⃣ 点击"🎯 商机通知模板"按钮
   自动打开编辑框，模板已填充

8️⃣ 修改模板名称、内容等

9️⃣ 点击"保存模板"

🔟 现在链接已包含ngrok地址，可在微信打开！
```

### 场景2：使用自己的域名

```
1️⃣ 准备域名
   https://yourdomain.com

2️⃣ 在模板管理中输入域名
   https://yourdomain.com

3️⃣ 点击"💾 保存域名配置"

4️⃣ 使用预设模板创建消息

5️⃣ 模板链接会自动使用该域名
```

### 场景3：本地开发，后期上线

```
当前（开发）：
• 域名：http://localhost:3000
• 创建模板

后期（上线）：
1. 更新域名配置为正式域名
2. 重新发送模板
3. 或直接编辑现有模板，修改链接
```

---

## ✨ 高级技巧

### 技巧1：快速切换域名

```
例如，你有多个环境：
• 开发：http://localhost:3000
• 测试：https://test.ngrok.io
• 生产：https://yourdomain.com

每次切换时：
1. 在域名输入框输入对应地址
2. 点击"💾 保存"
3. 创建/编辑模板时会自动使用最新域名
```

### 技巧2：批量创建模板

```
1. 点击"🎯 商机通知模板"
2. 修改模板名称和内容
3. 保存

4. 再点击"📦 订单确认模板"
5. 修改模板名称和内容
6. 保存

快速创建4个不同类型的模板！
```

### 技巧3：自定义模板内容

```
预设模板只是起点，你可以：
• 修改标题和问候语
• 添加公司信息
• 包含特殊的提示信息
• 调整变量的使用
• 添加个人签名

完全DIY！
```

### 技巧4：监控ngrok URL变化

```
如果ngrok URL频繁变化（免费版8小时变化一次）：

方案1：配置ngrok账号
• 登录ngrok.com
• 获取auth token
• 使用付费版保持URL不变

方案2：使用自动脚本
• 定时更新域名配置
• 自动发送最新链接

方案3：注册正式域名
• 购买域名（¥50/年）
• 一次配置，永久使用
```

---

## 📞 问题排查

**Q: 输入的域名没有保存？**
```
A: 确认点击了"💾 保存域名配置"按钮
   看到"✅ 域名配置已保存！"提示
```

**Q: 预设模板没有填充？**
```
A: 确认：
   1. 点击了对应的模板按钮
   2. 编辑对话框已打开
   3. 看到弹出消息"✅ 已加载..."
```

**Q: 模板中的链接还是本地地址？**
```
A: 
1. 检查是否保存了新的域名配置
2. 检查浏览器localStorage
   F12 → Application → Local Storage → baseUrl
3. 清除浏览器缓存后重试
```

**Q: ngrok URL频繁变化怎么办？**
```
A: 见上方"高级技巧4"的三种解决方案
```

---

## 🎉 现在就开始使用！

```
1️⃣ 打开：http://localhost:3000/templates

2️⃣ 展开：⚙️ 域名配置 & 快速模板

3️⃣ 配置：输入ngrok或自定义域名

4️⃣ 保存：点击"💾 保存域名配置"

5️⃣ 创建：点击任一预设模板按钮

6️⃣ 修改：编辑模板内容

7️⃣ 完成：点击"保存模板"
```

**就这么简单！** 🚀

现在你可以轻松创建和管理模板，支持ngrok和自定义域名配置。
